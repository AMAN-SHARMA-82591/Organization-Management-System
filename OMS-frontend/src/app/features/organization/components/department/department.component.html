<div class="flex items-center justify-between w-full p-2">
  <search-filter placeholder="Search Department" [handleChange]="onSearchChange">

  </search-filter>
  <button class="primary_button" type="button" (click)="handleModal()">
    Create New Department
  </button>
</div>

<app-loader *ngIf="isLoading"></app-loader>


<app-table *ngIf="!isLoading" [onDelete]="onDeleteDepartment" [onEdit]="onEditClick" [columns]="columns"
  [data]="departments" [title]="'Department'"></app-table>

<app-pagination (pageChange)="onPageChange($event)" [offset]="params.getValue().pageNum"
  [limit]="params.getValue().pageSize" [size]="totalDeps" [range]="3"></app-pagination>

<app-modal *ngIf="isModalOpen.getValue()">
  <h2 class="mb-4 text-xl font-bold text-primary-400 dark:text-white ">
    {{editMode ? 'Update Department' : 'New Department'}}
  </h2>
  <div class="w-full max-w-md mx-auto mt-8">
    <form [formGroup]="departmentForm" (ngSubmit)="editMode ? onSaveDepartment() : onSubmit()" class="rounded">
      <div class="mb-4">
        <label class="input_label" for="name">Name</label>
        <input type="text" id="name" formControlName="name" class="form_input" placeholder="e.g. Engineering" />

        <small class="text-red-500" *ngIf="departmentForm.controls['name'].touched &&
                  departmentForm.controls['name'].errors?.['required']
                ">This field is required</small>
        <small class="text-red-500"
          *ngIf="(departmentForm.controls['name'].errors?.['minlength'] || departmentForm.controls['name'].errors?.['maxlength'])">Enter
          department name within 5 to 30 characters</small>
      </div>

      <div class="mb-4">
        <label class="input_label" for="description">Description</label>
        <textarea rows="5" type="description" id="description" formControlName="description" class="form_input"
          placeholder="Description" style="resize: none"></textarea>
        <small class="text-red-500" *ngIf="
                  departmentForm.controls['description'].touched &&
                  departmentForm.controls['description'].errors?.['required']
                ">This field is required</small>
        <small class="text-red-500"
          *ngIf="(departmentForm.controls['description'].errors?.['minlength'] || departmentForm.controls['description'].errors?.['maxlength'])">Enter
          description written within 50 to 150 characters</small>
      </div>

      <div class="flex justify-end gap-2">
        <button [disabled]="departmentForm.invalid" type="submit" class="primary_button">
          {{editMode ? 'Save': 'Submit'}}
        </button>
        <button (click)="handleModal()" class="secondary_button" type="button">
          Cancel
        </button>
      </div>
    </form>
  </div>
</app-modal>